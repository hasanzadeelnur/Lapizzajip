@using Application.Features.AboutUs.Queries.GetData
@using Application.Features.Products.Queries.GetListSpeciality
@using Application.Features.Products.Queries.GetListSpecialityForCategory
@using Application.Features.Services.Queries.GetList
@using Application.Features.Sliders.Queries.GetList
@using Core.Application.Responses
@{
    List<GetListSliderDto> sliders = ViewData[nameof(IGeneralRepository.GetSliders)] as List<GetListSliderDto> ?? [];
    List<GetListSpecialityProductDto> specialityProducts = await generalRepository.GetSpecialityProducts();
    GetListSpecialityForCategoryProductResponse specialityForCategoryProduct = await generalRepository.GetSpecialityProductsForCategories();
    GetAboutUsResponse aboutus = ViewData[nameof(IGeneralRepository.GetAboutUs)] as GetAboutUsResponse ?? new();
    List<GetListServiceResponse> services = ViewData[nameof(IGeneralRepository.GetServices)] as List<GetListServiceResponse> ?? [];
    // GetListResponse<GetListPopularProductResponse> popularProducts = ViewData[nameof(IGeneralRepository.GetListPopularProduct)] as GetListResponse<GetListPopularProductResponse> ?? new();
    // GetListResponse<GetListLastProductResponse> lastProducts = ViewData[nameof(IGeneralRepository.GetListLastProduct)] as GetListResponse<GetListLastProductResponse> ?? new();
    // GetListResponse<GetListDealSliderResponse> dealSliders = ViewData[nameof(IGeneralRepository.GetListDealSlider)] as GetListResponse<GetListDealSliderResponse> ?? new();
    // var categories = lastProducts.Items.GroupBy(p => p.CategoryId).Select(p => new
    // {
    //     Id = p.Key,
    //     Name = p.FirstOrDefault()?.CategoryName
    // });
    Dictionary<string, string> settings = await generalRepository.GetSettings();
    Dictionary<string, string> textTranslations = await generalRepository.GetTranslations();
    TempData["Title"] = textTranslations["home_page_header_title"];
    TempData["MetaKeywords"] = textTranslations["home_page_keywords_meta"];
    TempData["MetaDescription"] = textTranslations["home_page_description_meta"];
    int sliderImageCount = 1;

}


<section class="banner" id="top">
    <div class="banner-carousel owl-carousel">
        @foreach (var slider in sliders)
        {
            <div class="banner-slide">
                <div class="container">
                    <div class="banner-box">
                        <div class="banner-text">
                            <div class="banner-center">
                                <h2 class="banner-headding">@slider.Title</h2>
                                <p class="banner-sub-hed">@slider.Subtitle</p>
                            </div>
                        </div>
                        <div class="banner-images">
                            <div class="all-img-banner">
                                <img src="@slider.ImagePath" alt="@slider.Title" class="pizza-img">
                                @foreach (var sliderImage in slider.Images)
                                {
                                    <img src="@sliderImage.ImagePath" alt="@slider.Title" class="pizza-it pizza-@sliderImageCount">
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {
                sliderImageCount = 1;
            }
        }

    </div>
</section>

<section class="order-section ptb">
    <div class="container">
        <div class="row">
            <div class="order-top"><img src="@settings["home_slider_top_image"]" alt="layer"></div>
            @foreach (GetListServiceResponse service in services)
            {
                <div class="col-xl-4 col-lg-4 col-md-4 servose-box text-center padding-lf wow fadeInUp">
                    <img src="@service.ImagePath" alt="order" class="order-img">
                    <h2 class="order-title text-uppercase">@service.Title</h2>
                    <p class="order-des">@service.Subtitle</p>
                </div>
            }
            <div class="order-bottom"><img src="@settings["home_slider_bottom_image"]" alt="layer"></div>
        </div>
    </div>
</section>

<section class="speciality ptb pt-140">
    <div class="container">
        <div class="row">
            <div class="col-xl-12 col-lg-12 col-md-12">
                <div class="headding-part text-center pb-50">
                    <p class="headding-sub wow fadeInUp">@textTranslations["home_our_speciality_title"]</p>
                    <h2 class="headding-title text-uppercase fw-bold wow fadeInUp">@textTranslations["home_our_speciality_subtitle"]</h2>
                </div>
            </div>
        </div>
        <div class="row">
            @foreach (var product in specialityProducts)
            {
                <div class="col-xl-4 col-lg-4 col-md-4 text-center speciality-box wow fadeInUp">
                    <div class="speciality-img"><a href="#"><img src="@product.ImagePath" alt="@product.Name" class="spec-image"></a></div>
                    <a href="#" class="ser-title text-uppercase fw-bold">@product.ShortDescription</a>
                </div>
            }
        </div>
        <div class="row">
            <div class="col-xl-12 col-lg-12 col-md-12 text-center">
                <a asp-controller="Menu" asp-action="Index" class="com-btn">@textTranslations["view_more_button"]</a>
            </div>
        </div>
    </div>
</section>

<section class="special-menu ptb pt-140">
    <div class="container">
        <div class="menu-top-bg"><img src="images/menu-top-bg.png" alt="meu-bg"></div>
        <div class="row">
            <div class="col-xl-12 col-lg-12 col-md-12">
                <div class="headding-part text-center pb-50">
                    <p class="headding-sub wow fadeInUp">@textTranslations["home_our_speciality_menu_title"]</p>
                    <h2 class="headding-title text-uppercase fw-bold wow fadeInUp">@textTranslations["home_our_speciality_menu_subtitle"]</h2>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xl-12 col-lg-12 col-md-12">
                <div class="special-tab text-center wow fadeInUp">
                    <ul id="tabs" class="nav nav-tabs" role="tablist">
                        <li class="text-uppercase fw-bold nav-item current" role="presentation">
                            <a href="#tab-1" class="nav-link active" id="all" data-bs-toggle="tab" data-bs-target="#data_all" role="tab" aria-selected="true"> @textTranslations["all_category_title"]</a>
                        </li>
                        @foreach (var category in specialityForCategoryProduct.Categories)
                        {
                            <li class="text-uppercase fw-bold nav-item" role="presentation">
                                <a href="#tab-2" class="nav-link" id="drinks" data-bs-toggle="tab" data-bs-target="#data_drinks" role="tab" aria-selected="false"> Drinks</a>
                                <a href="#category-@(category.Id)" class="nav-link" id="presentation-category-@(category.Id)" data-bs-toggle="tab" data-bs-target="#category-@(category.Id)" role="tab" aria-selected="false">@category.Name</a>
                            </li>
                        }
                    </ul>
                </div>
            </div>
        </div>
        <div class="tab-content wow fadeInUp">
            <div role="tabpanel" class="row our-menu-panel tab-pane fade in active show" role="tabpanel" id="data_all" aria-labelledby="all">
                @foreach (var product in specialityForCategoryProduct.Products)
                {
                    <div class="col-xl-3 col-lg-3 col-md-4 text-center menu-box">
                        <div class="menu-img"><a href="#"><img src="@product.SpecialImagePath" alt="menu" class="menu-image"></a></div>
                        <a href="#" class="menu-title text-uppercase">@product.Name</a>
                        <p class="menu-des">@product.ShortDescription</p>
                        <span class="menu-price">@product.Price ₩</span>
                    </div>
                }
            </div>
            @foreach (var category in specialityForCategoryProduct.Categories)
            {
                <div role="tabpanel" class="row our-menu-panel tab-pane fade" role="tabpanel" id="category-@(category.Id)" aria-labelledby="category-@(category.Id)">
                    @foreach (var product in specialityForCategoryProduct.Products)
                    {
                        <div class="col-xl-3 col-lg-3 col-md-4 text-center menu-box">
                            <div class="menu-img"><a href="#"><img src="@product.SpecialImagePath" alt="menu" class="menu-image"></a></div>
                            <a href="#" class="menu-title text-uppercase">@product.Name</a>
                            <p class="menu-des">@product.ShortDescription</p>
                            <span class="menu-price">@product.Price ₩</span>
                        </div>
                    }
                </div>
            }
        </div>
        <div class="menu-bottom-bg"><img src="~/assets/images/menu-bottom-bg.png" alt="menu-bg"></div>
    </div>
</section>

<section class="about-pizzon relative ptb">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-xl-6 col-lg-6 col-md-6 wow fadeInLeft">
                <div class="max-w-390">
                    @Html.Raw(aboutus.FirstBody)
                </div>
            </div>
            <div class="col-xl-6 col-lg-6 col-md-6 wow fadeInRight">
                <div class="about-pizzon-img">
                    <img src="@aboutus.FirstImagePath" alt="@textTranslations["about_us_page_title"]" class="pizzon-ab">
                </div>
            </div>
        </div>
    </div>
</section>